# üóÉÔ∏è Database Architecture

**–í–µ—Ä—Å–∏—è:** 2025-08-05 **–°—Ç–∞—Ç—É—Å:** ‚úÖ Canonical

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –≤ NEIRA Super App, –≤–∫–ª—é—á–∞—è –º–∏–≥—Ä–∞—Ü–∏–∏, —Å—Ö–µ–º—ã –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º.

---

## 1. –§–∏–ª–æ—Å–æ—Ñ–∏—è –∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤ NEIRA Super App —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–Ω—Ü–∏–ø–æ–º **–µ–¥–∏–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø—Ä–∞–≤–¥—ã (SSOT)** –¥–ª—è —Å—Ö–µ–º—ã:

1. **Drizzle ORM** ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ö–µ–º–æ–π –∏ –º–∏–≥—Ä–∞—Ü–∏–π
2. **–ö–æ–¥-–ø–µ—Ä–≤—ã–π –ø–æ–¥—Ö–æ–¥** ‚Äî —Å—Ö–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤ TypeScript, –º–∏–≥—Ä–∞—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏  
3. **–í–µ—Ä—Å–∏–æ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å** ‚Äî –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ Git
4. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** ‚Äî –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ CI/CD

**–ü—Ä–∏–Ω—Ü–∏–ø:** –ù–∏–∫–∞–∫–∏—Ö —Ä—É—á–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ö–µ–º—ã, –Ω–∏–∫–∞–∫–∏—Ö –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü.

---

## 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```mermaid
graph TD
    subgraph "Schema Definition"
        DS[drizzle/schema.ts]
        DM[drizzle/migrations/]
    end
    
    subgraph "Application Layer"
        PA[Polylith Components]
        SM[Shell Managers]
    end
    
    subgraph "Database Layer"
        SQ[SQLite Database]
        DR[Drizzle Client]
    end
    
    DS --> DM
    DM --> SQ
    PA --> DR
    SM --> DR
    DR --> SQ
    
    style DS fill:#e1f5fe
    style DM fill:#f3e5f5
    style SQ fill:#e8f5e8
```

---

## 3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
packages/neira-app/
‚îú‚îÄ‚îÄ drizzle/
‚îÇ   ‚îú‚îÄ‚îÄ schema.ts              # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã –≤ TypeScript
‚îÇ   ‚îú‚îÄ‚îÄ migrations/            # –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ SQL-–º–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 0001_initial.sql
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ 0002_add_users.sql
‚îÇ   ‚îî‚îÄ‚îÄ drizzle.config.ts      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Drizzle
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îî‚îÄ‚îÄ db/
‚îÇ       ‚îú‚îÄ‚îÄ client.ts          # –ö–ª–∏–µ–Ω—Ç –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
‚îÇ       ‚îî‚îÄ‚îÄ queries.ts         # –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
‚îî‚îÄ‚îÄ data/
    ‚îî‚îÄ‚îÄ neira.db              # SQLite —Ñ–∞–π–ª –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```

---

## 4. –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º–æ–π

### 4.1 –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Å—Ö–µ–º—ã

1. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** –°—Ö–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤ `drizzle/schema.ts` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Drizzle —Ç–∏–ø–æ–≤
2. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è:** –ö–æ–º–∞–Ω–¥–∞ `yarn db:generate` —Å–æ–∑–¥–∞–µ—Ç SQL-–º–∏–≥—Ä–∞—Ü–∏–∏
3. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ö–æ–º–∞–Ω–¥–∞ `yarn db:migrate` –ø—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
4. **–í–∞–ª–∏–¥–∞—Ü–∏—è:** CI/CD –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏

### 4.2 –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã
yarn db:generate

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –Ω–µ–ø—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã—Ö –º–∏–≥—Ä–∞—Ü–∏–π
yarn db:migrate

# –û—Ç–∫—Ä—ã—Ç–∏–µ Drizzle Studio –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
yarn db:studio

# –°–±—Ä–æ—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–û–°–¢–û–†–û–ñ–ù–û!)
yarn db:reset
```

### 4.3 –ü—Ä–∏–º–µ—Ä —Å—Ö–µ–º—ã

```typescript
// drizzle/schema.ts
import { sqliteTable, text, integer } from 'drizzle-orm/sqlite-core'

export const users = sqliteTable('users', {
  id: integer('id').primaryKey(),
  name: text('name').notNull(),
  email: text('email').unique().notNull(),
  createdAt: integer('created_at', { mode: 'timestamp' }).notNull()
})

export const chats = sqliteTable('chats', {
  id: text('id').primaryKey(),
  userId: integer('user_id').references(() => users.id),
  title: text('title').notNull(),
  createdAt: integer('created_at', { mode: 'timestamp' }).notNull()
})
```

---

## 5. –†–µ—à–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∏

### 5.1 –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥–≤–æ–π–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å—Ö–µ–º—ã (DATABASE:SCHEMA_UNIFICATION)

**–ü—Ä–æ–±–ª–µ–º–∞:** –§—É–Ω–∫—Ü–∏—è `ensureDatabaseSchema()` –≤ polylith-backend –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞–ª–∞ —Ç–∞–±–ª–∏—Ü—ã SQLite, –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—è —Å —Å–∏—Å—Ç–µ–º–æ–π –º–∏–≥—Ä–∞—Ü–∏–π Drizzle, —Å–æ–∑–¥–∞–≤–∞—è –¥–≤–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø—Ä–∞–≤–¥—ã –∏ —Ä–∏—Å–∫ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å—Ö–µ–º—ã.

**–†–µ—à–µ–Ω–∏–µ:**

1. –£–¥–∞–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `ensureDatabaseSchema` –∏ –µ—ë –≤—ã–∑–æ–≤
2. –£–¥–∞–ª–µ–Ω –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∏–º–ø–æ—Ä—Ç `SQLiteDatabase`
3. –î–æ–±–∞–≤–ª–µ–Ω `sqlite.pragma('foreign_keys = ON')` –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
4. –í CI/CD –¥–æ–±–∞–≤–ª–µ–Ω —à–∞–≥ `Run database migrations` –≤ `.github/workflows/build.yml`
5. –í troubleshooting-–≥–∞–π–¥ –¥–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª –æ–± –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –º–∏–≥—Ä–∞—Ü–∏—è—Ö

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

- ‚úÖ –°—Ö–µ–º–∞ –ë–î —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ Drizzle Migrations
- ‚úÖ –ü–∞–π–ø–ª–∞–π–Ω —Å–±–æ—Ä–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏  
- ‚úÖ –ö–æ–¥ —á–∏—â–µ –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è SQL
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–∞ –ë–î –≤ CI/CD
- ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω —Ä–∏—Å–∫ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É –∫–æ–¥–æ–º –∏ —Å—Ö–µ–º–æ–π –ë–î

### 5.2 –ü—Ä–∏–Ω—Ü–∏–ø—ã –µ–¥–∏–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø—Ä–∞–≤–¥—ã

| –ü—Ä–∏–Ω—Ü–∏–ø | –ë—ã–ª–æ (–¥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞) | –°—Ç–∞–ª–æ (–ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞) |
|---------|------------------------|----------------------------|
| **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü** | `ensureDatabaseSchema()` + Drizzle | –¢–æ–ª—å–∫–æ Drizzle migrations |
| **–ò—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã** | –î–≤–æ–π–Ω–æ–π (–∫–æ–¥ + SQL) | –ï–¥–∏–Ω—ã–π (TypeScript —Å—Ö–µ–º–∞) |
| **–í–∞–ª–∏–¥–∞—Ü–∏—è** | –†—É—á–Ω–∞—è | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤ CI/CD |
| **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π** | –†—É—á–Ω–æ–µ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ |

---

## 6. –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 6.1 –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

| –ö–æ–Ω—Ç–µ–∫—Å—Ç | –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ | –ü—Ä–∏–º–µ—Ä |
|----------|-------------------|---------|
| –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ö–µ–º—ã | –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è `schema.ts` + –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ | `yarn db:generate` |
| –ó–∞–ø—Ä–æ—Å—ã –∫ –ë–î | –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ Drizzle –∑–∞–ø—Ä–æ—Å—ã | `db.select().from(users).where(eq(users.id, 1))` |
| –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π | `yarn db:migrate` |
| –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Drizzle Studio | `yarn db:studio` |

### 6.2 –ê–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω—ã (—É—Å—Ç—Ä–∞–Ω–µ–Ω—ã)

| ‚ùå –ü–ª–æ—Ö–æ (–¥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞) | ‚úÖ –•–æ—Ä–æ—à–æ (–ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞) |
|----------------------------|--------------------------------|
| –†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –≤ –∫–æ–¥–µ | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ Drizzle migrations |
| SQL-–∑–∞–ø—Ä–æ—Å—ã —Å—Ç—Ä–æ–∫–∞–º–∏ | –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ Drizzle queries |
| –î–≤–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ —Å—Ö–µ–º—ã | –ï–¥–∏–Ω—ã–π source of truth –≤ TypeScript |
| –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ CI/CD |

---

## 7. CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### 7.1 GitHub Actions

```yaml
# .github/workflows/build.yml
- name: Run database migrations
  run: |
    yarn db:migrate
    # –í–∞–ª–∏–¥–∞—Ü–∏—è —á—Ç–æ —Ñ–∞–π–ª –ë–î —Å–æ–∑–¥–∞–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
    if [ ! -f "packages/neira-app/data/neira.db" ]; then
      echo "Database file not found after migration"
      exit 1
    fi
```

### 7.2 –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

- ‚úÖ **Syntax validation** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ SQL –≤ –º–∏–≥—Ä–∞—Ü–∏—è—Ö
- ‚úÖ **Schema consistency** ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ TypeScript —Å—Ö–µ–º—ã –∏ –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã—Ö –º–∏–≥—Ä–∞—Ü–∏–π  
- ‚úÖ **Foreign keys** ‚Äî –≤–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **Database file validation** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–∞ –ë–î

---

## 8. Troubleshooting

### 8.1 –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

| –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|----------|---------|---------|
| Migration –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è | –ù–µ–∞–∫—Ç—É–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ | –ó–∞–ø—É—Å—Ç–∏—Ç—å `yarn db:generate && yarn db:migrate` |
| Foreign key constraints | –û—Ç–∫–ª—é—á–µ–Ω—ã FK | –î–æ–±–∞–≤–∏—Ç—å `pragma('foreign_keys = ON')` |
| Database locked | –û—Ç–∫—Ä—ã—Ç—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è | –ó–∞–∫—Ä—ã—Ç—å –≤—Å–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î |
| Schema drift | –†—É—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ë–î | –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –ë–î –∏–∑ –º–∏–≥—Ä–∞—Ü–∏–π |

### 8.2 –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π
yarn drizzle-kit introspect:sqlite

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–ª–∏—á–∏–π –º–µ–∂–¥—É —Å—Ö–µ–º–æ–π –∏ –ë–î
yarn drizzle-kit check:sqlite

# –°–±—Ä–æ—Å –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –ë–î
rm packages/neira-app/data/neira.db
yarn db:migrate
```

---

## 9. Performance –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### 9.1 –ò–Ω–¥–µ–∫—Å—ã

```typescript
// –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ —Å—Ö–µ–º–µ
export const users = sqliteTable('users', {
  // ...
}, (table) => ({
  emailIdx: index('email_idx').on(table.email),
  createdAtIdx: index('created_at_idx').on(table.createdAt)
}))
```

### 9.2 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SQLite

```typescript
// lib/db/client.ts
import { drizzle } from 'drizzle-orm/better-sqlite3'
import Database from 'better-sqlite3'

const sqlite = new Database('data/neira.db')

// –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
sqlite.pragma('journal_mode = WAL')
sqlite.pragma('synchronous = NORMAL')
sqlite.pragma('foreign_keys = ON')
sqlite.pragma('temp_store = MEMORY')

export const db = drizzle(sqlite)
```

---

## 10. Revision History

| –î–∞—Ç–∞ | –í–µ—Ä—Å–∏—è | –ò–∑–º–µ–Ω–µ–Ω–∏–µ | ID –ó–Ω–∞–Ω–∏—è |
|------|--------|-----------|-----------|
| 2025-08-05 | 1.0 | –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å—Ö–µ–º–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ | DATABASE:SCHEMA_UNIFICATION |

---

## 11. –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [Polylith Architecture](/03-core-concepts/1-architecture-patterns/10-polylith-architecture) ‚Äî –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ë–î –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
- [Code Organization](/03-core-concepts/1-architecture-patterns/03-code-organization) ‚Äî –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–æ–µ–∫—Ç–µ
- [Security Principles](/03-core-concepts/1-architecture-patterns/08-security-principles) ‚Äî –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ë–î
