# Интеграция расширений с UI

## 1. Общий подход

Интеграция расширений с пользовательским интерфейсом `neira-app` происходит через IPC-каналы, управляемые `ExtensionsManager`. `shell` предоставляет `neira-app` необходимые данные и методы для отображения и взаимодействия с расширениями.

## 2. Отображение иконок (`browserAction`)

Иконки `browserAction` (иконки на панели инструментов) являются ключевым элементом UI для многих расширений. Корректное отображение этих иконок важно для UX.

### 2.1. Устраненная проблема: Неправильный подбор иконок

В ранних версиях существовал баг, из-за которого иконки расширений могли отображаться в низком качестве или не соответствовать контексту.

**Проблема:**

- Функция `matchSize`, отвечающая за подбор иконки нужного размера из манифеста расширения, работала некорректно.
- Она всегда возвращала первую доступную иконку, игнорируя запрошенный UI размер (например, 16x16, 32x32).

**Решение:**

- Логика функции `matchSize` была исправлена.
- Теперь она анализирует все доступные в манифесте иконки и выбирает ту, которая наиболее точно соответствует запрошенному размеру, согласно стандартному поведению Chrome.

**Результат:**
Иконки расширений всегда отображаются в наилучшем доступном качестве, что улучшает визуальную составляющую приложения.

## 3. Контекстные меню

Пункты контекстного меню, добавляемые расширениями, интегрируются в общее контекстное меню приложения с помощью пакета `electron-chrome-context-menu`. `ExtensionsManager` собирает эти пункты и передает их для отображения в соответствующем месте.
