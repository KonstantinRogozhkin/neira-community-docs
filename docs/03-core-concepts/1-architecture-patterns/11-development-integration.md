# üèóÔ∏è VS Code-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ NEIRA Super App

> **–°–≤–æ–¥–∫–∞:** NEIRA Super App —Ä–µ–Ω–¥–µ—Ä–∏—Ç UI –∫–∞–∫ **—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞–∫–µ—Ç Next.js** –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç –µ–≥–æ —á–µ—Ä–µ–∑ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π **`neira://` –ø—Ä–æ—Ç–æ–∫–æ–ª**. –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ **IPC-API** –±–µ–∑ HTTP-—Å–µ—Ä–≤–µ—Ä–æ–≤.

## –ö–ª—é—á–µ–≤—ã–µ –∏–¥–µ–∏

1. **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –±–∏–ª–¥** (`output: 'export'`) ‚Äî Next.js –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —á–∏—Å—Ç—ã–µ html/js/css.
2. **–ö–∞—Å—Ç–æ–º–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª** `neira://` ‚Äî –±—Ä–∞—É–∑–µ—Ä–Ω—ã–π –∞–Ω–∞–ª–æ–≥ `file://`, –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–π main-–ø—Ä–æ—Ü–µ—Å—Å–æ–º.
3. **IPC-API –≤–º–µ—Å—Ç–æ REST** ‚Äî –ª—é–±—ã–µ –¥–∞–Ω–Ω—ã–µ/–¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã Electron IPC.
4. **Zero Ports** ‚Äî –≤ production –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã; –≤ dev –≤–æ–∑–º–æ–∂–µ–Ω HTTP-fallback.

## –°–æ—Å—Ç–∞–≤ –º–æ–¥—É–ª–µ–π

| –ú–æ–¥—É–ª—å                   | –§–∞–π–ª                                             | –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å                                                              |
| ------------------------ | ------------------------------------------------ | ---------------------------------------------------------------------------- |
| **ProtocolHandler**      | `packages/shell/src/main/protocol-handler.ts`    | –†–∞–∑—Ä–µ—à–∞–µ—Ç URL `neira://‚Ä¶` ‚Üí –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—É—Ç—å –∫ `neira-app/out`.                |
| **APIManager**           | `packages/shell/src/main/managers/APIManager.ts` | –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑—É–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç IPC-—Ö–µ–Ω–¥–ª–µ—Ä—ã.                      |
| **Preload (IPC-bridge)** | `packages/shell/src/preload/index.ts`            | –≠–∫—Å–ø–æ—Ä—Ç `window.neiraAPI`, –ø–µ—Ä–µ—Ö–≤–∞—Ç `fetch`, –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –≤ IPC. |
| **IPC –∫–ª–∏–µ–Ω—Ç**           | `packages/neira-app/lib/ipc-api.ts`              | –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏–∑ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.                                 |

## –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```mermaid
sequenceDiagram
    participant React19 as neira-app (renderer)
    participant Preload as preload
    participant Main as main process

    React19->>Preload: window.neiraAPI.invoke('chat:send', payload)
    Preload->>Main: ipcRenderer.invoke('chat:send', payload)
    Main->>APIManager: handleChatMessage(payload)
    APIManager-->>Main: ChatResponse
    Main-->>Preload: result
    Preload-->>React19: result
```

## IPC-–∫–∞–Ω–∞–ª—ã (–≤—ã–±–æ—Ä–∫–∞)

| –ö–∞–Ω–∞–ª         | –ú–µ—Ç–æ–¥ APIManager    | –í–æ–∑–≤—Ä–∞—Ç        |
| ------------- | ------------------- | -------------- |
| `chat:send`   | `handleChatMessage` | `ChatResponse` |
| `chats:list`  | `handleGetChats`    | `Chat[]`       |
| `models:list` | `handleGetModels`   | `Model[]`      |

## Dev ‚Üî Prod —Ä–µ–∂–∏–º—ã

```bash
# Development (HTTP + hot-reload)
STATIC_MODE=0 yarn dev:neira-app && yarn start

# Production (Static + IPC)
yarn build          # –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç neira-app/out
STATIC_MODE=1 yarn start
```

IPC-–∫–ª–∏–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç transport:

```ts
export async function callAPI(endpoint: string, data?: unknown) \{
  if (typeof window !== 'undefined' && window.neiraAPI) \{
    return window.neiraAPI.invoke(endpoint, data)
  }
  return fetch(`/api/${endpoint}`, \{ method: 'POST', body: JSON.stringify(data) })
}
```

## Best Practices

- **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã + IPC > HTTP-—Å–µ—Ä–≤–µ—Ä**: –î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (–∫–∞–∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö, —Ç–∞–∫ –∏ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö) –≤—Å–µ–≥–¥–∞ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–π—Ç–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏, –æ–±—Å–ª—É–∂–∏–≤–∞–µ–º—ã–º–∏ —á–µ—Ä–µ–∑ –∫–∞—Å—Ç–æ–º–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª, –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ–º —á–µ—Ä–µ–∑ IPC. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–∞—Ö –≤ production, –ø–æ–≤—ã—à–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.
- **–ò–Ω—ä–µ–∫—Ü–∏—è `<base>` —Ç–µ–≥–∞ –¥–ª—è —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π**: –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å URL —Ä–µ—Å—É—Ä—Å–æ–≤ "–Ω–∞ –ª–µ—Ç—É", –∏–Ω—ä–µ–∫—Ç–∏—Ä—É–π—Ç–µ –≤ HTML-—Ñ–∞–π–ª —Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ç–µ–≥ `<base href="neira://your-app-root/">`. –≠—Ç–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±, –∫–æ—Ç–æ—Ä—ã–π –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –±—Ä–∞—É–∑–µ—Ä –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–∑—Ä–µ—à–∞—Ç—å –≤—Å–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏.
- **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ IPC-–∫–∞–Ω–∞–ª—ã –∏ —Ç–∏–ø—ã**: –î–µ—Ä–∂–∏—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤—Å–µ—Ö IPC-–∫–∞–Ω–∞–ª–æ–≤ –∏ –∏—Ö —Ç–∏–ø–∏–∑–∞—Ü–∏—é –≤ –µ–¥–∏–Ω–æ–º –º–µ—Å—Ç–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ `shared-types/`, —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –º–µ–∂–¥—É `main` –∏ `renderer` –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏.
- **–ü–∞—Å—Å–∏–≤–Ω—ã–π UI (Passive-Store)**: –°—Ç–∞—Ä–∞–π—Ç–µ—Å—å –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –∏–ª–∏ –¥–æ–ª–≥–æ–∂–∏–≤—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ renderer-–ø—Ä–æ—Ü–µ—Å—Å–µ. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ UI-—Å—Ç–æ—Ä—ã (Zustand) —Ç–æ–ª—å–∫–æ –¥–ª—è —ç—Ñ–µ–º–µ—Ä–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –∞ –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–∞–π—Ç–µ –∏–∑ `main` –ø—Ä–æ—Ü–µ—Å—Å–∞ —á–µ—Ä–µ–∑ IPC-—Å–æ–±—ã—Ç–∏—è.
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–±–æ—Ä–∫–∏ –≤ CI**: –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ, —á—Ç–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ (`yarn build`) –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ –≤ —Ä–∞–º–∫–∞—Ö CI/CD –ø–∞–π–ø–ª–∞–π–Ω–∞, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–±–ª–µ–º –≤ production.

---

**–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞**

- **–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 2025-06-17
- **–ü—Ä–æ–≤–µ—Ä–∏–ª:** AI-Reviewer
- **–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏:** –§–∞–π–ª –æ—Ç—Ä–∞–∂–∞–µ—Ç —Ç–µ–∫—É—â—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é `protocol-handler.ts`, `APIManager.ts` –∏ unified preload (Phase 3 IPC —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞). –£–ø–æ–º—è–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç, —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞ –≤ production. –î—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ `docs/` –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ.

---
