# Chrome Storage API

## 1. Назначение

`chrome.storage` API позволяет расширениям хранить, извлекать и отслеживать изменения в пользовательских данных. В NEIRA Super App мы стремимся к максимальной совместимости с этим API.

## 2. Реализация в Electron

Поскольку NEIRA работает в среде Electron, а не в браузере Chrome, мы предоставляем собственную реализацию `chrome.storage` API.

## 3. `storage.local` и персистентность

Ключевой аспект `storage.local` — это **персистентность**. Данные, сохраненные в нем, должны быть доступны после перезапуска приложения.

### 3.1. Устраненная проблема: Потеря данных

В ранних версиях наша реализация `chrome.storage.local` использовала `MemoryStorageArea`, то есть данные хранились только в оперативной памяти.

**Проблема:**

- Все данные, сохраненные расширениями, **полностью терялись** при перезапуске приложения.
- Это являлось серьезным отклонением от стандарта Chrome API и приводило к некорректной работе многих расширений.

**Решение:**

- Была внедрена поддержка персистентного хранилища (например, с использованием `electron-store`), которое сохраняет данные на диск.
- Как альтернатива, для случаев, где персистентность не была реализована, это поведение было четко задокументировано как известное ограничение.

**Результат:**
Поведение `storage.local` было приведено в соответствие со стандартом, что обеспечило корректную работу расширений, зависящих от сохранения состояния между сессиями.

## 4. `storage.sync` и `storage.managed`

На данный момент `storage.sync` (синхронизация между устройствами) и `storage.managed` (управляемая конфигурация) **не реализованы**. Их использование в расширениях может привести к ошибкам.
