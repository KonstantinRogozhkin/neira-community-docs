# üõ°Ô∏è –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

> **–°—Ç–∞—Ç—É—Å:** –ê–∫—Ç—É–∞–ª—å–Ω–æ  
> **–í–µ—Ä—Å–∏—è:** 1.0.0  
> **–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-07-01  
> **–ò—Å—Ç–æ—á–Ω–∏–∫:** –ê–Ω–∞–ª–∏–∑ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –∏ –∞—É–¥–∏—Ç –∫–æ–¥–∞

## üìã –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –∏ –ø—Ä–∞–∫—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã —Å–æ–±–ª—é–¥–∞—Ç—å—Å—è –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ NEIRA Super App. –û—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ —É–¥–µ–ª—è–µ—Ç—Å—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–æ–º–∞–Ω–¥, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—é injection –∞—Ç–∞–∫ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–º –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

## üîê –ü—Ä–∏–Ω—Ü–∏–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. –ü—Ä–∏–Ω—Ü–∏–ø –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π

- –†–∞–∑—Ä–µ—à–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–∞–Ω–¥—ã –∏ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å whitelist –≤–º–µ—Å—Ç–æ blacklist –ø–æ–¥—Ö–æ–¥–æ–≤

### 2. –ì–ª—É–±–æ–∫–∞—è –∑–∞—â–∏—Ç–∞ (Defense in Depth)

- –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É—Ä–æ–≤–Ω—è—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–∞—Ä—å–µ—Ä—ã –∑–∞—â–∏—Ç—ã
- Fail-safe –º–µ—Ö–∞–Ω–∏–∑–º—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

### 3. –ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫ –Ω–∞—Ä—É—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –†–µ–≥—É–ª—è—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ security events

## ‚ö° –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥

### –ü—Ä–æ–±–ª–µ–º–∞: –£—è–∑–≤–∏–º–æ—Å—Ç—å blacklist –ø–æ–¥—Ö–æ–¥–∞

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å** –≤ `TaskExecutionService`:

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ (blacklist) –≤–º–µ—Å—Ç–æ –±–µ–ª–æ–≥–æ —Å–ø–∏—Å–∫–∞ (whitelist)
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—Ö–æ–¥–∞ –∑–∞—â–∏—Ç—ã —á–µ—Ä–µ–∑ –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–º–∞–Ω–¥

### –†–µ—à–µ–Ω–∏–µ: Whitelist –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```typescript
// ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê
interface CommandValidator {
  validate(command: string, params: any[]): ValidationResult
}

const ALLOWED_COMMANDS = {
  desktop_click: DesktopClickValidator,
  browser_navigate: BrowserNavigateValidator,
  file_read: FileReadValidator,
} as const

class SecurityManager {
  validateCommand(command: string, params: any[]): ValidationResult {
    const validator = ALLOWED_COMMANDS[command]
    if (!validator) {
      this.logSecurityViolation('unknown_command', { command })
      return { valid: false, reason: 'Command not in allowlist' }
    }

    return validator.validate(command, params)
  }
}
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

```typescript
// –ü—Ä–∏–º–µ—Ä –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º zod
import { z } from 'zod'

class DesktopClickValidator implements CommandValidator {
  private schema = z.object({
    x: z.number().min(0).max(10000),
    y: z.number().min(0).max(10000),
    button: z.enum(['left', 'right', 'middle']),
  })

  validate(command: string, params: any[]): ValidationResult {
    try {
      this.schema.parse(params[0])
      return { valid: true }
    } catch (error) {
      return {
        valid: false,
        reason: `Invalid parameters: ${error.message}`,
      }
    }
  }
}
```

## üîÑ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –ü–æ—ç—Ç–∞–ø–Ω—ã–π rollout —Å feature flags

```typescript
// –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —Å –æ—Ç–∫–∞—Ç–æ–º
const validateCommand = (command: string, params: any[]) => {
  if (FEATURE_FLAGS.USE_WHITELIST_VALIDATION) {
    return whitelistValidator.validate(command, params)
  }
  return legacyBlacklistValidator.validate(command, params)
}
```

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**

- [ ] –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–µ—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –∫–æ–º–∞–Ω–¥: **100%**
- [ ] –ó–∞—â–∏—Ç–∞ –æ—Ç injection –∞—Ç–∞–∫: **100%**
- [ ] –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏: **100%**
- [ ] –í—Ä–µ–º—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏: **sub-1ms**

## üö® –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

```typescript
const SECURITY_METRICS = {
  'security.command_validation_time': histogram(),
  'security.blocked_commands_count': counter(),
  'security.injection_attempts': counter(),
  'security.validation_failures': counter(),
}
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ security events

```typescript
class SecurityLogger {
  logSecurityViolation(type: string, context: any) {
    this.logger.warn('SECURITY_VIOLATION', {
      type,
      context: sanitizeContext(context),
      timestamp: new Date().toISOString(),
      severity: this.getSeverity(type),
    })
  }
}
```

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [–ó–æ–ª–æ—Ç—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏](/contributing/golden-principles) - –ø—Ä–∏–Ω—Ü–∏–ø "Secure-by-Default"
- [–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π](/contributing/circular-dependency-prevention)
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π](/contributing/extension-security-guidelines)

---

**–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞**

- **–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-07-01
- **–ò–∑–≤–ª–µ—á–µ–Ω–æ –∏–∑:** –ê—É–¥–∏—Ç –∫–æ–¥–∞ NEIRA Super App, –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø (—Ä–µ–π—Ç–∏–Ω–≥ 95)
- **–°—Ç–∞—Ç—É—Å –≤–∞–ª–∏–¥–∞—Ü–∏–∏:** ‚úÖ –£—è–∑–≤–∏–º–æ—Å—Ç–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã –∞—É–¥–∏—Ç–æ–º
