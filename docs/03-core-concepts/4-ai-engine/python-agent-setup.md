# üêç Python Agent Setup & Architecture

**–í–µ—Ä—Å–∏—è:** 1.2  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–î–µ–π—Å—Ç–≤—É—é—â–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç**

## ‚ö° –§–∏–ª–æ—Å–æ—Ñ–∏—è

–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á, —Ç—Ä–µ–±—É—é—â–∏—Ö —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã Python (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–±–æ—Ç–∞ —Å ML-–º–æ–¥–µ–ª—è–º–∏, —Å–ª–æ–∂–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö), NEIRA Super App –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥. `PythonAPIManager` –≤ `shell` –≤—ã—Å—Ç—É–ø–∞–µ—Ç –≤ —Ä–æ–ª–∏ –º–æ—Å—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–º Python-–±—ç–∫–µ–Ω–¥–æ–º, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –±–µ—Å—à–æ–≤–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –º–∏—Ä–∞–º–∏ Node.js –∏ Python —á–µ—Ä–µ–∑ –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª gRPC.

**–ü—Ä–∏–Ω—Ü–∏–ø:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—É—á—à–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏. JavaScript –¥–ª—è UI –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è, Python ‚Äî –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∏ AI.

**–°–≤—è–∑–∏:** [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ú–µ–Ω–µ–¥–∂–µ—Ä–æ–≤](/core-concepts/architecture-patterns/manager-architecture).

## üèõÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –õ–æ–∫–∞–ª—å–Ω—ã–π –±—ç–∫–µ–Ω–¥ –∏ gRPC

–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ –∑–∞–ø—É—Å–∫–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ Python-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫–∞–∫ –¥–æ—á–µ—Ä–Ω–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ —Å –Ω–∏–º —á–µ—Ä–µ–∑ gRPC.

```mermaid
graph TD
    subgraph "shell (Main Process)"
        A[PythonAPIManager]
    end

    subgraph "Python Backend (Child Process)"
        B[–ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª Python]
        C[gRPC Server]
        B --> C
    end

    A -- "spawn()" --> B
    A -- "gRPC Client" <--> C

    style B fill:#333,stroke:#555
    style C fill:#444,stroke:#666
```

### `PythonAPIManager`

–≠—Ç–æ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É–µ—Ç –ª–æ–≥–∏–∫—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Python-–∞–≥–µ–Ω—Ç–æ–º.

1. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–º**:

   - **–ó–∞–ø—É—Å–∫ –∏ –æ–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ (Robust Initialization)**: –ü—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ `PythonAPIManager` –Ω–∞—Ö–æ–¥–∏—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª Python-–∞–≥–µ–Ω—Ç–∞. –û–Ω –∞–∫—Ç–∏–≤–Ω–æ —Å–ª—É—à–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥ (`stdout`) –¥–æ—á–µ—Ä–Ω–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –æ–∂–∏–¥–∞—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–∞—Ä–∫–µ—Ä (`AGENT_READY`), –∫–æ—Ç–æ—Ä—ã–π —Å–∏–≥–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∞–≥–µ–Ω—Ç–∞.
   - **–ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å**: –ü—É—Ç—å –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã (`process.platform`) –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (`process.arch`), —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É –Ω–∞ macOS (ARM/Intel), Windows –∏ Linux.
   - **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å**: –ï—Å–ª–∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∞ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –≤ **mock-—Ä–µ–∂–∏–º**. –≠—Ç–æ—Ç –∂–µ —Ä–µ–∂–∏–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –µ—Å–ª–∏ –∞–≥–µ–Ω—Ç –Ω–µ —Å–º–æ–≥ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –∏–ª–∏ –ø—Ä–æ–π—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–µ—Å—Ç–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É UI –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–º–µ—Ç—å –∑–∞–ø—É—â–µ–Ω–Ω—ã–π Python-–±—ç–∫–µ–Ω–¥.

2. **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —á–µ—Ä–µ–∑ gRPC**:
   - **–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ**: –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ Python-–ø—Ä–æ—Ü–µ—Å—Å–∞, –º–µ–Ω–µ–¥–∂–µ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç gRPC-–∫–ª–∏–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ gRPC-—Å–µ—Ä–≤–µ—Ä—É –≤–Ω—É—Ç—Ä–∏ Python-–∞–≥–µ–Ω—Ç–∞. –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Unix-—Å–æ–∫–µ—Ç** (–Ω–∞ macOS/Linux) –∏–ª–∏ **–∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π –∫–∞–Ω–∞–ª** (–Ω–∞ Windows).
   - **Health Check —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π**: –ï—Å–ª–∏ –º–∞—Ä–∫–µ—Ä `AGENT_READY` –Ω–µ –±—ã–ª –ø–æ–ª—É—á–µ–Ω –≤–æ–≤—Ä–µ–º—è, `PythonAPIManager` –Ω–µ —Å–¥–∞—ë—Ç—Å—è. –û–Ω –∑–∞–ø—É—Å–∫–∞–µ—Ç –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –ø—Ä–æ–≤–µ—Ä–∫–∏: –≤—ã–ø–æ–ª–Ω—è–µ—Ç –¥–æ 3-—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—ã–∑–æ–≤–∞ `healthCheck()` —Å –Ω–∞—Ä–∞—Å—Ç–∞—é—â–µ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π (0.5—Å, 1—Å, 2—Å). –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ (exponential backoff) –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–∂–¥–∞—Ç—å—Å—è –ø–æ–ª–Ω–æ–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∞–≥–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è, –∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—à–∞–µ—Ç –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏.
   - **API**: –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ, —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã (`processPrompt`, `callCustomFunction`) –¥–ª—è –≤—ã–∑–æ–≤–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä –Ω–∞ Python-—Å–µ—Ä–≤–µ—Ä–µ. –í—Å—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å gRPC —Å–∫—Ä—ã—Ç–∞ –∑–∞ —ç—Ç–∏–º–∏ –ø—Ä–æ—Å—Ç—ã–º–∏ –≤—ã–∑–æ–≤–∞–º–∏.

### Python-–∞–≥–µ–Ω—Ç

- **–ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª**: –≠—Ç–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å –ø–æ–º–æ—â—å—é PyInstaller (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∞) Python-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ Python –∏–ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
- **gRPC-—Å–µ—Ä–≤–µ—Ä**: –í–Ω—É—Ç—Ä–∏ Python-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è gRPC-—Å–µ—Ä–≤–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Å–µ—Ä–≤–∏—Å—ã, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤ `.proto` —Ñ–∞–π–ª–∞—Ö. –û–Ω —Å–ª—É—à–∞–µ—Ç –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º —Å–æ–∫–µ—Ç–µ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –æ—Ç `PythonAPIManager`. 