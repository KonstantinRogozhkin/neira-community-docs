graph TD
    %% –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è —É–∑–ª–æ–≤
    classDef build_tool fill:#FFF3CD,stroke:#FFC107,color:#664d03,stroke-width:2px;
    classDef core_lib fill:#D1E7DD,stroke:#198754,color:#0f5132,stroke-width:2px;
    classDef app_ui fill:#CFF4FC,stroke:#0D6EFD,color:#055160,stroke-width:2px;
    classDef main_process fill:#F8D7DA,stroke:#DC3545,color:#842029,stroke-width:4px;
    classDef external fill:#E9D5FF,stroke:#9B59B6,color:#5e3370,stroke-width:2px;

    %% –ë–ª–æ–∫ 1: –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∫–∏ –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ (–Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ)
    subgraph " "
        direction LR
        subgraph "Build & Orchestration"
            ROOT_PKG["<b>package.json</b><br/>(yarn workspaces, scripts)"]
            TURBO["<b>turbo.json</b><br/>(Build Dependency Graph)"]
        end
    end
    class ROOT_PKG,TURBO build_tool;

    %% –ë–ª–æ–∫ 2: –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø–∞–∫–µ—Ç—ã (monorepo)
    subgraph "packages/"
        subgraph "core/ (–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ —è–¥—Ä–∞)"
            CORE_SHELL["
                <b>shell</b>
                <br/>
                <i>Electron Main Process</i>
                <br/>
                - IPCManager
                - WindowManager
                - <b>AppManager (Marketplace)</b>
            "]:::main_process

            CORE_SHARED_TYPES["üìú <b>shared-types</b><br/>(–ö–æ–Ω—Ç—Ä–∞–∫—Ç API –∏ —Ç–∏–ø—ã)"]:::core_lib
            CORE_UI_SHARED["üé® <b>ui-shared</b><br/>(–û–±—â–∏–µ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)"]:::core_lib
            CORE_HOOKS_SHARED["ü™ù <b>hooks-shared</b><br/>(–û–±—â–∏–µ React —Ö—É–∫–∏)"]:::core_lib
        end

        subgraph "apps/ (–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ UI –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è)"
            APP_LIBRECHAT["<b>librechat-ui</b><br/>(UI –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)"]:::app_ui
            APP_MARKETPLACE["<b>marketplace-ui</b><br/>(–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è 'App Store')"]:::app_ui
        end
    end

    %% –ë–ª–æ–∫ 3: –í–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)
    subgraph "External World"
        EXT_REGISTRY["<b>neira-apps</b><br/>(GitHub Repo —Å index.json)"]:::external
    end


    %% –°–≤—è–∑–∏ –∏ –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

    %% 1. –ü—Ä–æ—Ü–µ—Å—Å —Å–±–æ—Ä–∫–∏ (Build-Time)
    ROOT_PKG -- "invokes" --> TURBO;
    TURBO -- "orchestrates build for" --> CORE_SHELL;
    TURBO -- "orchestrates build for" --> APP_LIBRECHAT;
    TURBO -- "orchestrates build for" --> APP_MARKETPLACE;
    
    %% 2. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–∞–º–∏ (Compile-Time)
    APP_LIBRECHAT -->|Uses Components| CORE_UI_SHARED;
    APP_LIBRECHAT -->|Uses Hooks| CORE_HOOKS_SHARED;
    APP_LIBRECHAT -->|Uses Types| CORE_SHARED_TYPES;

    APP_MARKETPLACE -->|Uses Components| CORE_UI_SHARED;
    APP_MARKETPLACE -->|Uses Hooks| CORE_HOOKS_SHARED;
    APP_MARKETPLACE -->|Uses Types| CORE_SHARED_TYPES;

    CORE_SHELL -->|Uses Types| CORE_SHARED_TYPES;
    CORE_UI_SHARED -->|Uses Types, e.g. for props| CORE_SHARED_TYPES;

    %% 3. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã (Run-Time)
    CORE_SHELL <-.->|<b>IPC Bridge</b><br/>–¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è —Å–≤—è–∑—å| APP_LIBRECHAT;
    CORE_SHELL <-.->|<b>IPC Bridge</b>| APP_MARKETPLACE;
    
    CORE_SHELL -.->|Fetches app list| EXT_REGISTRY