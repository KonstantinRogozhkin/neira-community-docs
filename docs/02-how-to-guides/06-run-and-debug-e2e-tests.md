# üß™ –ó–∞–ø—É—Å–∫ –∏ –æ—Ç–ª–∞–¥–∫–∞ E2E —Ç–µ—Å—Ç–æ–≤

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–î–µ–π—Å—Ç–≤—É—é—â–∏–π –≥–∞–π–¥**  
**–ü—Ä–∏–º–µ–Ω–∏–º–æ –∫:** NEIRA Super App v2+

## üéØ –ö—Ä–∞—Ç–∫–∏–π –æ–±–∑–æ—Ä

E2E —Ç–µ—Å—Ç—ã –≤ NEIRA Super App –∏—Å–ø–æ–ª—å–∑—É—é—Ç Playwright –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤. –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º Electron –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —Å –ø–æ–ª–Ω—ã–º —Å—Ç–µ–∫–æ–º: Shell ‚Üí neira-app ‚Üí MCP –∞–≥–µ–Ω—Ç—ã.

**–°–≤—è–∑–∏:** [–°–∏—Å—Ç–µ–º–Ω—ã–π –æ–±–∑–æ—Ä](/core-concepts/architecture-patterns/system-overview), [Troubleshooting](/how-to-guides/troubleshooting-common-issues)

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ó–∞–ø—É—Å–∫ MVP —Ç–µ—Å—Ç–æ–≤

```bash
# –ó–∞–ø—É—Å–∫ –±–∞–∑–æ–≤–æ–≥–æ smoke —Ç–µ—Å—Ç–∞
npx playwright test tests/3_smoke/comprehensive-health.spec.ts

# –ó–∞–ø—É—Å–∫ MVP Demo Scenario
npx playwright test tests/2_e2e/agent-mom-mvp.spec.ts
```

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö E2E —Ç–µ—Å—Ç–æ–≤

```bash
# –ü–æ–ª–Ω—ã–π –ø—Ä–æ–≥–æ–Ω (–∑–∞–π–º–µ—Ç 10-15 –º–∏–Ω—É—Ç)
yarn test:e2e

# –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
npx playwright test tests/2_e2e/ --grep="core"
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–µ—Å—Ç–æ–≤ (41 –∞–∫—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç)

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è         | –§–∞–π–ª—ã                                   | –û–ø–∏—Å–∞–Ω–∏–µ                              |
| ----------------- | --------------------------------------- | ------------------------------------- |
| **Smoke Tests**   | `tests/3_smoke/`                        | –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—É—Å–∫–∞ (3 —Ç–µ—Å—Ç–∞)    |
| **E2E Scenarios** | `tests/2_e2e/`                          | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (14 —Ç–µ—Å—Ç–æ–≤) |
| **Integration**   | `tests/1_integration/`                  | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (26 —Ç–µ—Å—Ç–æ–≤)   |
| **Visual Tests**  | `tests/2_e2e/visual-regression.spec.ts` | –í–∏–∑—É–∞–ª—å–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è (8 —Ç–µ—Å—Ç–æ–≤)       |

### –ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

```gherkin
# MVP Demo Scenario (–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô)
GIVEN –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç NEIRA Super App
WHEN –≤—ã–±–∏—Ä–∞–µ—Ç –∞–≥–µ–Ω—Ç–∞ "–ú–∞–º–∞"
AND –≤–≤–æ–¥–∏—Ç —Ü–µ–ª—å "–Ω–∞–π—Ç–∏ –∫—É—Ä—Å BTC"
WHEN –∑–∞–ø—É—Å–∫–∞–µ—Ç –∞–≥–µ–Ω—Ç–∞
THEN –∞–≥–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç browser.navigate
AND –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–∏—Å–∫
AND –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –∫—É—Ä—Å–æ–º
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 18+
- Playwright –±—Ä–∞—É–∑–µ—Ä—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- Electron app —Å–æ–±—Ä–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Playwright
npx playwright install

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
npx playwright --version
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

–¢–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```typescript
// playwright.config.ts
export default defineConfig(\{
  webServer: \{
    command: 'yarn start:test-server',
    port: 3000,
    reuseExistingServer: !process.env.CI,
  }
})
```

## üêõ –û—Ç–ª–∞–¥–∫–∞ —Ç–µ—Å—Ç–æ–≤

### –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏

```bash
# –ó–∞–ø—É—Å–∫ —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º –±—Ä–∞—É–∑–µ—Ä–æ–º
npx playwright test --headed

# –ü–æ—à–∞–≥–æ–≤–∞—è –æ—Ç–ª–∞–¥–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
npx playwright test tests/2_e2e/agent-mom-mvp.spec.ts --debug

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ —Ç–µ—Å—Ç–∞
npx playwright codegen
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤

```bash
# –ò–Ω—Å–ø–µ–∫—Ç–æ—Ä —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
npx playwright test --ui

# –ü—Ä–æ–≤–µ—Ä–∫–∞ data-testid –≤ –±—Ä–∞—É–∑–µ—Ä–µ
# DevTools Console:
document.querySelector('[data-testid="chat-input"]')
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```typescript
// –í–∫–ª—é—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Ç–µ—Å—Ç–∞—Ö
test.beforeEach(async (\{ page }) => \{
  page.on('console', msg => console.log('BROWSER:', msg.text()))
  page.on('pageerror', err => console.error('PAGE ERROR:', err))
})
```

## üö® –†–µ—à–µ–Ω–∏–µ —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: WebServer –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:** `Error: server did not start at http://localhost:3000`

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# 1. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –ø–æ—Ä—Ç —Å–≤–æ–±–æ–¥–µ–Ω
lsof -ti:3000 | xargs kill -9

# 2. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –≤—Ä—É—á–Ω—É—é
yarn start:test-server

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
open http://localhost:3000
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã

**–°–∏–º–ø—Ç–æ–º—ã:** –¢–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö UI

**–†–µ—à–µ–Ω–∏–µ:**

```typescript
// ‚ùå –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ
await page.click('.MuiButton-root:nth-child(2)')

// ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ
await page.click('[data-testid="send-message-button"]')
```

### –ü—Ä–æ–±–ª–µ–º–∞: gRPC –æ—à–∏–±–∫–∏ –≤ —Ç–µ—Å—Ç–∞—Ö

**–°–∏–º–ø—Ç–æ–º—ã:** `Error: gRPC server connection failed`

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# –û—Ç–∫–ª—é—á–∏—Ç—å gRPC –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
TEST_MODE=true yarn start:test-server
```

## üìã –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–æ–≤–æ–≥–æ —Ç–µ—Å—Ç–∞

```typescript
import \{ test, expect } from '@playwright/test'

test.describe('New Feature Tests', () => \{
  test.beforeEach(async (\{ page }) => \{
    // –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
    await page.goto('/')
    await expect(page).toHaveTitle(/NEIRA Super App/)
  })

  test('should test new feature', async (\{ page }) => \{
    // 1. Arrange - –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    await page.fill('[data-testid="input-field"]', 'test data')

    // 2. Act - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
    await page.click('[data-testid="submit-button"]')

    // 3. Assert - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    await expect(page.locator('[data-testid="result"]')).toContainText('expected result')
  })
})
```

### –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `data-testid` –≤–º–µ—Å—Ç–æ CSS –∫–ª–∞—Å—Å–æ–≤
- –ì—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –≤ `describe` –±–ª–æ–∫–∏
- –î–æ–±–∞–≤–ª—è–π—Ç–µ –æ–∂–∏–¥–∞–Ω–∏—è –¥–ª—è async –æ–ø–µ—Ä–∞—Ü–∏–π
- –û—á–∏—â–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞

## üéØ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞

### –¶–µ–ª–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

- **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** &gt;95% pass rate
- **–°–∫–æ—Ä–æ—Å—Ç—å:** Smoke —Ç–µ—Å—Ç—ã –º–µ–Ω–µ–µ 2 –º–∏–Ω—É—Ç
- **–ü–æ–∫—Ä—ã—Ç–∏–µ:** –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—É—Ç–∏ –ø–æ–∫—Ä—ã—Ç—ã

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

- [ ] Smoke —Ç–µ—Å—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç –ª–æ–∫–∞–ª—å–Ω–æ
- [ ] MVP Demo Scenario —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ù–µ—Ç –ø–∞–¥–µ–Ω–∏–π –Ω–∞ gRPC –æ—à–∏–±–∫–∞—Ö
- [ ] –í—Å–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç data-testid

## ü©π –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∏–∫—Å—ã E2E (—è–Ω–≤–∞—Ä—å 2025)

–í —Ö–æ–¥–µ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤–æ–π –º–∞—Ç—Ä–∏—Ü—ã –±—ã–ª–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã –ø–µ—Ä–≤—ã–µ P0-–ø—Ä–æ–±–ª–µ–º—ã:

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è             | –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ                                                                 | –†–µ–∑—É–ª—å—Ç–∞—Ç              |
| --------------------- | --------------------------------------------------------------------------- | ---------------------- |
| **API Channels**      | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –≤ —Ç–µ—Å—Ç–µ `api-models` (`Array.isArray(result.data)`) | ‚úÖ –¢–µ—Å—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç       |
| **Chat UI —Å–µ–ª–µ–∫—Ç–æ—Ä—ã** | –î–æ–±–∞–≤–ª–µ–Ω—ã `data-testid` (`chat-interface`, `message-input`, `message-list`) | ‚úÖ –°–µ–ª–µ–∫—Ç–æ—Ä—ã —Å—Ç–∞–±–∏–ª—å–Ω—ã |

–û—Å—Ç–∞–≤—à–∏–µ—Å—è –∑–∞–¥–∞—á–∏:

- –î–æ–±–∞–≤–∏—Ç—å —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è AI-Tools (`data-role="assistant"`, etc.)
- –ú–µ—Ç–∫–∏ –∞–≥–µ–Ω—Ç–æ–≤ (`data-testid="agent-mom"`) –∏ –¥—Ä—É–≥–∏–µ
- –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É `Target page, context or browser has been closed`

> –ü–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á—ë—Ç: `docs/archive/2025-07/e2e-tests-critical-fixes-initial.md`

---

**–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞**

- **–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 2025-01-08
- **–ü—Ä–æ–≤–µ—Ä–∏–ª:** Doc Builder
- **–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏:** –°–æ–∑–¥–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ E2E_CRISIS_REPORT.md –∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç–µ—Å—Ç–æ–≤
