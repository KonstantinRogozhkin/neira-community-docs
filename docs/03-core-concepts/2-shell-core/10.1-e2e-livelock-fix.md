# ‚ö°Ô∏è –ö–µ–πc: –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ livelock (100 % CPU) –≤ E2E-—Ç–µ—Å—Ç–∞—Ö

–í–µ—Ä—Å–∏—è: 1.0 (2025-01-06)
–°—Ç–∞—Ç—É—Å: ‚úÖ **–í–Ω–µ–¥—Ä–µ–Ω–æ –≤ master**

## üîç –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ Playwright-—Ç–µ—Å—Ç–æ–≤ Electron-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ¬´–∑–∞–ª–∏–ø–∞–ª–æ¬ª –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, –ø—Ä–æ–¥–æ–ª–∂–∞—è –ø–æ—Ç—Ä–µ–±–ª—è—Ç—å 100 % CPU. –í–æ–∑–Ω–∏–∫–∞–ª–∏ ¬´–∑–æ–º–±–∏¬ª-–ø—Ä–æ—Ü–µ—Å—Å—ã, CI –∑–∞–≤–∏—Å–∞–ª.

## üõ†Ô∏è –ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è

1. **Graceful + Force Shutdown**
   ‚Ä¢ `packages/shell/src/main/index.ts` ‚Äî —Ç–∞–π–º–∞—É—Ç 5 —Å –¥–ª—è `app.quit()` –ø–µ—Ä–µ–¥ `app.exit(1)`.
2. **–û—á–∏—Å—Ç–∫–∞ —Ç–∞–π–º–µ—Ä–æ–≤ Web Store Updater**
   ‚Ä¢ `packages/electron-chrome-web-store/src/browser/updater.ts` ‚Äî `clearInterval` –≤ —Ö—É–∫–µ `beforeQuit`.
3. **–ù–∞–¥—ë–∂–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞**
   ‚Ä¢ `tests/helpers/electron-test-base.ts` ‚Äî –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ PID, –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ —É–±–∏–π—Å—Ç–≤–æ –ø—Ä–∏ teardown.
   ‚Ä¢ `global-teardown.ts` ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –∑–∞—á–∏—Å—Ç–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.
4. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Playwright**
   ‚Ä¢ –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ `webServer`, –¥–æ–±–∞–≤–ª–µ–Ω `globalTeardown`.

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç

| –ú–µ—Ç—Ä–∏–∫–∞          | –î–æ            | –ü–æ—Å–ª–µ   |
| ---------------- | ------------- | ------- |
| –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞ | ‚àû (–∑–∞–≤–∏—Å–∞–Ω–∏–µ) | 15-60 —Å |
| CPU –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤ | 100 %         | ‚â§5 %    |
| Zombie Electron  | 5-10+         | 0       |

## üß© –ü–∞—Ç—Ç–µ—Ä–Ω—ã –∫ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

- **PID-tracking** –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ Electron.
- **Timeout-Protection** –≤–æ–∫—Ä—É–≥ –¥–æ–ª–∏ –∫–æ–¥–∞, –±–ª–æ–∫–∏—Ä—É—é—â–µ–π quit.
- **Global Teardown** –≤ —Ç–µ—Å—Ç–∞—Ö –¥–æ–ª–∂–µ–Ω —á–∏—Å—Ç–∏—Ç—å –≤—Å—ë.

- –ü–æ–¥—Ä–æ–±–Ω—ã–π –ø–æ—à–∞–≥–æ–≤—ã–π —Ä–∞–∑–±–æ—Ä —Å–º. –≤ `docs/archive/processed/e2e-livelock-fix-report.md` (–¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∞—É–¥–∏—Ç–∞).
